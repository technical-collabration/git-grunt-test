!function(a){"use strict";var b={common:{init:function(){var c=a(".wrap-survey-section"),d=a(".survey-noitem"),e=!1;c.length<=0||(a("#publishing-action #publish,#minor-publishing-actions #save-post").on("click",function(){e=!1}),a(window).bind("beforeunload",function(){return e?postL10n.saveAlert:void 0}),a("select[multiple]").change(function(){var b=a(this);a.each(b.val(),function(a,c){""!=c&&b.val().length>1&&(b.find("option")[0].selected=!1)})}),a("ul.survey-category li a").on("click",function(){var c=a(this).data("type");b.common.add_survey_question_field(c,[]),e=!0}),"undefined"!=typeof pafb_survey_items&&(a.each(pafb_survey_items.reverse(),function(a,c){b.common.add_survey_question_field(c.type,c)}),pafb_survey_items.length<=0?d.show():d.hide()),c.sortable({connectWith:c,item:".postbox[class!=item-confirmation]",cursor:"move",scrollSpeed:1e3,placeholder:"ui-state-highlight",handle:"h3"}),c.disableSelection(),c.on("keyup","input[id=survey-question]",function(){var b=a(this),c=b.closest(".inside").parent(".postbox").find(".survey-item-preview");b.val().length<=90?c.text(b.val()):b.val().length>=95&&c.text(b.val().substring(0,90)+"..."),e=!0}),a.each(a(".wrap-survey-section .postbox"),function(){a(this).toggleClass("closed")}),c.on("click",".survey-item-remove",function(){var b=a(this).closest(".inside").parent(".wrap-survey-section .postbox");b.remove();var c=a(".wrap-survey-section .postbox").length;0>=c&&d.fadeIn(),e=!0}),a(document.body).on("sortupdate",".postbox",function(a,b){b.item.hasClass("item-confirmation")&&(b.item.appendTo(c),e=!0)}),c.on("click","a.choice-add-input",function(){b.common.add_choice_input_field(a(this),c,""),e=!0}),c.on("click","a.choice-remove-input",function(){b.common.remove_choice_input_field(a(this)),e=!0}),a("ul#choice-items").sortable({cursor:"move",scrollSpeed:1e3,placeholder:"ui-state-highlight-choice"}),a(".add-sample-survey-quetions").on("click",function(){b.common.add_sample_questions(),e=!0}))},add_survey_question_field:function(c,d){var e=b.common.get_items_size(),f=[];switch(c){case"positive-negative":f.push(['<div class="postbox  item-'+c+'">','<div class="handlediv"  title=""><br></div>',"<h3>",'<span class="survey-item-preview"  id="survey-item-preview">'+("undefined"!=typeof d.question?d.question:"")+"</span>","</h3>",'<div class="inside">',"<hr/>",'<div class="survey-item" >','<div style="padding:10px;">',"<div>",'<label for="survey-question">'+pafb_labels.question+"</label>",'<input type="text" name="pafb_survey_questions[pafb_questions_item]['+e+'][question]" value="'+("undefined"!=typeof d.question?d.question:"")+'" id="survey-question" style="width:100%;"  />',"</div>","</div>",'<div style="padding:10px;">',"<div>",'<label for="">'+pafb_labels.positive+":","<br/>",'<input type="text" name="pafb_survey_questions[pafb_questions_item]['+e+'][positive]" value="'+("undefined"!=typeof d.positive?d.positive:"")+'" style="width:100%;" />',"</label>","</div>","</div>",'<div style="padding:10px;">',"<div>",'<label for="">'+pafb_labels.negative+":</label>","<br/>",'<input type="text" name="pafb_survey_questions[pafb_questions_item]['+e+'][negative]"  value="'+("undefined"!=typeof d.negative?d.negative:"")+'" style="width:100%;" />',"</div>","</div>",'<div style="padding:10px;">',"<div>","<label>",'<input type="checkbox" value="1" name="pafb_survey_questions[pafb_questions_item]['+e+'][required]"  '+("undefined"!=typeof d.required&&1==d.required?'checked="checked"':"")+" />",""+pafb_labels.required+"</label>","</div>","</div>",'<div style="padding:10px;">','<a href="javascript:;" class="survey-item-remove button">','<span class="dashicons dashicons-trash" style="margin-top: 3px;"></span>',"</a>","</div>","</div>",'<input type="hidden" value="'+c+'" name="pafb_survey_questions[pafb_questions_item]['+e+'][type]"   />',"</div>","</div>"].join(""));break;case"choice":var g=[];"undefined"!=typeof d.choices&&d.choices.length>0?a.each(d.choices,function(a,b){""!=b&&g.push(["<li>",'<input type="text" name="pafb_survey_questions[pafb_questions_item]['+e+'][choices][]" value="'+b+'"  />','<a href="javascript:;"  class="button choice-add-input"><span class="dashicons dashicons-plus"></span></a>','<a href="javascript:;"  class="button choice-remove-input"><span class="dashicons dashicons-minus"></span></a>',"</li>"].join(""))}):g.push(["<li>",'<input type="text" name="pafb_survey_questions[pafb_questions_item]['+e+'][choices][]"  />','<a href="javascript:;"  class="button choice-add-input"><span class="dashicons dashicons-plus"></span></a>','<a href="javascript:;"  class="button choice-remove-input"><span class="dashicons dashicons-minus"></span></a>',"</li>"].join("")),f.push(['<div class="postbox  item-'+c+'">','<div class="handlediv"  title=""><br></div>',"<h3>",'<span class="survey-item-preview"  id="survey-item-preview">'+("undefined"!=typeof d.question?d.question:"")+"</span>","</h3>",'<div class="inside">',"<hr/>",'<div class="survey-item" >','<div style="padding:10px;">',"<div>",'<label for="survey-question">'+pafb_labels.question+"</label>",'<input type="text" name="pafb_survey_questions[pafb_questions_item]['+e+'][question]" value="'+("undefined"!=typeof d.question?d.question:"")+'" id="survey-question" style="width:100%;"  />',"</div>","</div>",'<div style="padding:10px;">',"<div>","<label>"+pafb_labels.choices+"</label>",'<ul class="choice-items" id="choice-items" data-id="'+e+'">',g.join(""),"</ul>","</div>","</div>",'<div style="padding:10px;">',"<div>","<label>",'<input type="checkbox" value="1" name="pafb_survey_questions[pafb_questions_item]['+e+'][multiple_choice]"  '+("undefined"!=typeof d.multiple_choice&&1==d.multiple_choice?'checked="checked"':"")+" />",""+pafb_labels.multiple_choice+"</label>","</div>","</div>",'<div style="padding:10px;">',"<div>","<label>",'<input type="checkbox" value="1" name="pafb_survey_questions[pafb_questions_item]['+e+'][required]"  '+("undefined"!=typeof d.required&&1==d.required?'checked="checked"':"")+" />",""+pafb_labels.required+"</label>","</div>","</div>",'<div style="padding:10px;">','<a href="javascript:;" class="survey-item-remove button">','<span class="dashicons dashicons-trash" style="margin-top: 3px;"></span>',"</a>","</div>","</div>",'<input type="hidden" value="'+c+'" name="pafb_survey_questions[pafb_questions_item]['+e+'][type]"   />',"</div>","</div>"].join(""));break;case"rating":f.push(['<div class="postbox  item-'+c+'">','<div class="handlediv"  title=""><br></div>',"<h3>",'<span class="survey-item-preview"  id="survey-item-preview">'+("undefined"!=typeof d.question?d.question:"")+"</span>","</h3>",'<div class="inside">',"<hr/>",'<div class="survey-item" >','<div style="padding:10px;">',"<div>",'<label for="survey-question">'+pafb_labels.question+"</label>",'<input type="text" name="pafb_survey_questions[pafb_questions_item]['+e+'][question]" value="'+("undefined"!=typeof d.question?d.question:"")+'" id="survey-question" style="width:100%;"  />',"</div>","</div>",'<div style="padding:10px;">',"<div>",'<label for="">'+pafb_labels.positive+":","<br/>",'<input type="text" name="pafb_survey_questions[pafb_questions_item]['+e+'][positive]" value="'+("undefined"!=typeof d.positive?d.positive:"")+'" style="width:100%;" />',"</label>","</div>","</div>",'<div style="padding:10px;">',"<div>",'<label for="">'+pafb_labels.negative+":</label>","<br/>",'<input type="text" name="pafb_survey_questions[pafb_questions_item]['+e+'][negative]"  value="'+("undefined"!=typeof d.negative?d.negative:"")+'" style="width:100%;" />',"</div>","</div>",'<div style="padding:10px;">',"<div>",'<label for="">'+pafb_labels.rating_range+":</label>","<br/>",'<select name="pafb_survey_questions[pafb_questions_item]['+e+'][rating_range]">','<option value="5"  '+("undefined"!=typeof d.rating_range&&5==d.rating_range?'selected="selected"':"")+">1 to 5</option>",'<option value="10" '+("undefined"!=typeof d.rating_range&&10==d.rating_range?'selected="selected"':"")+">1 to 10</option>","</select>","</div>","</div>",'<div style="padding:10px;">',"<div>","<label>",'<input type="checkbox" value="1" name="pafb_survey_questions[pafb_questions_item]['+e+'][required]"  '+("undefined"!=typeof d.required&&1==d.required?'checked="checked"':"")+" />",""+pafb_labels.required+"</label>","</div>","</div>",'<div style="padding:10px;">','<a href="javascript:;" class="survey-item-remove button">','<span class="dashicons dashicons-trash" style="margin-top: 3px;"></span>',"</a>","</div>","</div>",'<input type="hidden" value="'+c+'" name="pafb_survey_questions[pafb_questions_item]['+e+'][type]"   />',"</div>","</div>"].join(""));break;case"email":f.push(['<div class="postbox  item-'+c+'">','<div class="handlediv"  title=""><br></div>',"<h3>",'<span class="survey-item-preview"  id="survey-item-preview">'+("undefined"!=typeof d.question?d.question:"")+"</span>","</h3>",'<div class="inside">',"<hr/>",'<div class="survey-item" >','<div style="padding:10px;">',"<div>",'<label for="survey-question">'+pafb_labels.question+"</label>",'<input type="text" name="pafb_survey_questions[pafb_questions_item]['+e+'][question]" value="'+("undefined"!=typeof d.question?d.question:"")+'" id="survey-question" style="width:100%;"  />',"</div>","</div>",'<div style="padding:10px;">',"<div>",'<label for="survey-question">'+pafb_labels.placeholder_text+"</label>",'<input type="text" name="pafb_survey_questions[pafb_questions_item]['+e+'][placeholder_text]" value="'+("undefined"!=typeof d.placeholder_text?d.placeholder_text:"")+'" style="width:100%;"  />',"</div>","</div>",'<div style="padding:10px;">',"<div>","<label>",'<input type="checkbox" value="1" name="pafb_survey_questions[pafb_questions_item]['+e+'][required]"  '+("undefined"!=typeof d.required&&1==d.required?'checked="checked"':"")+" />",""+pafb_labels.required+"</label>","</div>","</div>",'<div style="padding:10px;">','<a href="javascript:;" class="survey-item-remove button">','<span class="dashicons dashicons-trash" style="margin-top: 3px;"></span>',"</a>","</div>","</div>",'<input type="hidden" value="'+c+'" name="pafb_survey_questions[pafb_questions_item]['+e+'][type]"   />',"</div>","</div>"].join(""));break;case"singlefield":f.push(['<div class="postbox  item-'+c+'">','<div class="handlediv"  title=""><br></div>',"<h3>",'<span class="survey-item-preview"  id="survey-item-preview">'+("undefined"!=typeof d.question?d.question:"")+"</span>","</h3>",'<div class="inside">',"<hr/>",'<div class="survey-item" >','<div style="padding:10px;">',"<div>",'<label for="survey-question">'+pafb_labels.question+"</label>",'<input type="text" name="pafb_survey_questions[pafb_questions_item]['+e+'][question]" value="'+("undefined"!=typeof d.question?d.question:"")+'" id="survey-question" style="width:100%;"  />',"</div>","</div>",'<div style="padding:10px;">',"<div>",'<label for="survey-question">'+pafb_labels.placeholder_text+"</label>",'<input type="text" name="pafb_survey_questions[pafb_questions_item]['+e+'][placeholder_text]" value="'+("undefined"!=typeof d.placeholder_text?d.placeholder_text:"")+'" style="width:100%;"  />',"</div>","</div>",'<div style="padding:10px;">',"<div>","<label>",'<input type="checkbox" value="1" name="pafb_survey_questions[pafb_questions_item]['+e+'][required]"  '+("undefined"!=typeof d.required&&1==d.required?'checked="checked"':"")+" />",""+pafb_labels.required+"</label>","</div>","</div>",'<div style="padding:10px;">','<a href="javascript:;" class="survey-item-remove button">','<span class="dashicons dashicons-trash" style="margin-top: 3px;"></span>',"</a>","</div>","</div>",'<input type="hidden" value="'+c+'" name="pafb_survey_questions[pafb_questions_item]['+e+'][type]"   />',"</div>","</div>"].join(""));break;case"multiplefield":f.push(['<div class="postbox  item-'+c+'">','<div class="handlediv"  title=""><br></div>',"<h3>",'<span class="survey-item-preview"  id="survey-item-preview">'+("undefined"!=typeof d.question?d.question:"")+"</span>","</h3>",'<div class="inside">',"<hr/>",'<div class="survey-item" >','<div style="padding:10px;">',"<div>",'<label for="survey-question">'+pafb_labels.question+"</label>",'<input type="text" name="pafb_survey_questions[pafb_questions_item]['+e+'][question]" value="'+("undefined"!=typeof d.question?d.question:"")+'" id="survey-question" style="width:100%;"  />',"</div>","</div>",'<div style="padding:10px;">',"<div>",'<label for="survey-question">'+pafb_labels.placeholder_text+"</label>",'<textarea name="pafb_survey_questions[pafb_questions_item]['+e+'][placeholder_text]" style="width:100%;">'+("undefined"!=typeof d.placeholder_text?d.placeholder_text:"")+"</textarea>","</div>","</div>",'<div style="padding:10px;">',"<div>","<label>",'<input type="checkbox" value="1" name="pafb_survey_questions[pafb_questions_item]['+e+'][required]"  '+("undefined"!=typeof d.required&&1==d.required?'checked="checked"':"")+" />",""+pafb_labels.required+"</label>","</div>","</div>",'<div style="padding:10px;">','<a href="javascript:;" class="survey-item-remove button">','<span class="dashicons dashicons-trash" style="margin-top: 3px;"></span>',"</a>","</div>","</div>",'<input type="hidden" value="'+c+'" name="pafb_survey_questions[pafb_questions_item]['+e+'][type]"   />',"</div>","</div>"].join(""));break;case"confirmation":a(".item-"+c).size()<=0&&f.push(['<div class="postbox item-'+c+'" id="item-'+c+'">','<div class="handlediv"  title=""><br></div>',"<h3>",'<span class="survey-item-preview"  id="survey-item-preview">'+("undefined"!=typeof d.confirmation?d.confirmation:"")+"</span>","</h3>",'<div class="inside">',"<hr/>",'<div class="survey-item" >','<div style="padding:10px;">',"<div>",'<label for="survey-question">'+pafb_labels.confirmation+"</label>",'<textarea name="pafb_survey_questions[pafb_questions_item]['+e+'][confirmation]" id="survey-question" style="width:100%;">',"Thank you for your feedback!","</textarea>","</div>","</div>",'<div style="padding:10px;">','<a href="javascript:;" class="survey-item-remove button">','<span class="dashicons dashicons-trash" style="margin-top: 3px;"></span>',"</a>","</div>","</div>",'<input type="hidden" value="'+c+'" name="pafb_survey_questions[pafb_questions_item]['+e+'][type]"   />',"</div>","</div>"].join(""))}b.common.append_question_field(f)},add_choice_input_field:function(b,c,d){var e=c.find("ul.choice-items").data("id"),f=[];f=["<li>",'<input type="text" name="pafb_survey_questions[pafb_questions_item]['+e+'][choices][]" value=""  />','<a href="javascript:;"  class="button choice-add-input"><span class="dashicons dashicons-plus"></span></a>','<a href="javascript:;"  class="button choice-remove-input"><span class="dashicons dashicons-minus"></span></a>',"</li>"],f.length>0&&b.parent("li").after(f.join("")),a("ul#choice-items").sortable({cursor:"move",scrollSpeed:1e3,placeholder:"ui-state-highlight-choice"})},remove_choice_input_field:function(a){var b=a.parent("li");b.remove()},append_question_field:function(c){a(".wrap-survey-section").prepend(c.join(""));var d=b.common.get_items_size();d>0?a(".wrap-survey-section .survey-noitem").hide():a(".wrap-survey-section .survey-noitem").show()},get_items_size:function(){var b=a(".survey-item").size();return b},add_sample_questions:function(){var c=[];c.push({type:"positive-negative",question:"Was this article helpful?",positive:"Helpful",negative:"Not Helpful",required:!0}),c.push({type:"choice",question:"What appeals to you most about this post?",choices:["Grammar","Choice of Topic","Delivery","Story","Everything"],required:!0}),c.push({type:"rating",question:"On a scale of 1-10, please rate the helpfulness of this article.",rating_range:10,positive:"Very Helpful",negative:"Not Helfpul",required:!0}),c.push({type:"email",question:"If you need us to contact you please provide your email below.",placeholder_text:"Email",required:!0}),c.push({type:"singlefield",question:"If you need us to contact you please provide your name below.",placeholder_text:"Name",required:!0}),c.push({type:"multiplefield",question:"Please tell us how we can improve this artlce?",placeholder_text:"We know there is value in constructive criticism",required:!0}),c.push({type:"confirmation",confirmation:"Thank you for your feedback!"}),a.each(c.reverse(),function(a,c){b.common.add_survey_question_field(c.type,c)})}}},c={fire:function(a,c,d){var e=b;c=void 0===c?"init":c,""!==a&&e[a]&&"function"==typeof e[a][c]&&e[a][c](d)},loadEvents:function(){c.fire("common"),a.each(document.body.className.replace(/-/g,"_").split(/\s+/),function(a,b){c.fire(b)})}};a.fn.shuffle=function(){return this.each(function(){var b=a(this).children().clone(!0);return b.length?a(this).html(a.shuffle(b)):this})},a.shuffle=function(a){for(var b,c,d=a.length;d;b=parseInt(Math.random()*d),c=a[--d],a[d]=a[b],a[b]=c);return a},a(document).ready(c.loadEvents)}(jQuery);